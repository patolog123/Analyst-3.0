## Use Case: AI-агент для генерации постов на основе истории Telegram-канала

### 1. Название
Автоматическая генерация постов на основе истории канала Telegram с помощью AI-агента

### 2. Идентификатор
UC-CONTENT-BOT-002

### 3. Главный актор
Автор блога (владелец Telegram-канала)

#### Вспомогательные акторы
- Telegram-бот (AI-агент)
- Telegram API (Bot API + Channel Post)
- Хранилище данных (база истории постов)

### 4. Предусловия
- Telegram-бот добавлен в канал в качестве администратора с правами читать сообщения.
- У канала есть хотя бы 3 поста для начального анализа.
- Бот настроен на приём обновлений типа `channel_post`.
- AI-модуль готов к анализу текста и генерации контента.

### 5. Ограничения
- Бот получает только посты, опубликованные **после** его добавления.
- Для получения старых постов требуется ручной импорт или Telegram API через MTProto.
- Объём анализа может быть ограничен по количеству сообщений (например, последние 50 постов).
- Сложность генерации ограничена ресурсами хостинга и лимитами LLM API.

### 6. Триггер
Пользователь:
- добавляет бота в Telegram-канал.

### 7. Основной сценарий
1. Пользователь отправляет команду `/newpost` в чат с ботом.
2. Бот анализирует сохранённую историю публикаций (темы, стиль, структура).
3. Бот предлагает 2–3 идеи для нового поста.
4. Пользователь выбирает идею.
5. Бот предлагает структуру поста.
6. Пользователь подтверждает.
7. Бот генерирует черновик поста.
8. Пользователь получает итоговый текст.

### 8. Альтернативный сценарий

- А.1 (шаг 1):

1. Пользователь понимает, что бот не видит старые посты и отправляет команду `/add_posts`.

2. Бот предлагает пользователю несколько вариантов загрузки истории:
    - вручную скопировать и вставить тексты постов;
    - загрузить `.txt` или `.csv` файл со всеми постами;
    - отправить экспорт Telegram-канала из `my.telegram.org`.
3. Пользователь выбирает способ загрузки:
    - Вариант А: Вручную вставляет 5–10 текстов постов в чат с ботом (по одному или списком).
    - Вариант B: Загружает файл с историей постов.
4. Бот сохраняет каждый пост в базу данных и подтверждает успешную загрузку.
5. После загрузки не менее 3 постов бот сообщает: "Готов предложить новые идеи на основе истории. Напишите `/newpost` или дождитесь следующего триггера."

- А.4 (шаг 4):

4. Пользователь не выбирает идею и вводит собственную тему.

- А.6 (шаг 6):

6. Пользователь отправляет команду `/style` для смены стилистики.


### 9. Исключительные сценарии
- 2.1: Бот не имеет прав на чтение постов канала → сообщает об ошибке.
- 4.1: Нет истории постов → бот запрашивает примеры вручную.
- 9.1: Ошибка генерации текста (API сбой, лимиты) → бот предлагает повторить.

### 10. Критерии успеха
- AI-агент сформировал релевантный черновик поста, соответствующий стилю канала.
- Пользователь получил идеи и финальный текст для публикации.
- История постов успешно сохранена и используется для будущих генераций.
- Поддерживается непрерывное улучшение качества контента без ручного труда.

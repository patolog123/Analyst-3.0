# Acceptance Criteria (AC) для AI Agent Маркетолог

## AC-001: Получение статистики по клиентам и услугам
**Дано:** пользователь (маркетолог) авторизован и имеет доступ к телеграм-боту.  
**Когда:** пользователь отправляет запрос с указанием метрики, например:  
`Сколько клиентов купили услугу X за период Y`  
**Тогда:**
- система принимает запрос через телеграм-бота и передает его ИИ агенту;
- ИИ агент формирует корректный API-запрос к внешней системе **Yclients**;
- внешняя система возвращает данные по записям услуг за указанный период;
- ИИ агент обрабатывает данные и возвращает их в систему;
- система отправляет пользователю ответ с аналитикой и рекомендациями;
- ответ содержит корректные данные по услугам: **id, название, стоимость, количество**, а также данные по сотрудникам (**id, ФИО, специализация**);
- время отклика системы не превышает **30 секунд** при нормальной нагрузке.

---

## AC-002: Обработка ошибок и исключительных ситуаций
**Дано:** пользователь авторизован и отправляет запрос в телеграм-бот.  
**Когда:**
- внешний сервис возвращает пустой ответ;
- либо ИИ агент не может обработать данные.  
**Тогда:**
- телеграм-бот сообщает пользователю, что **данные не найдены** (в случае пустого ответа);
- телеграм-бот информирует пользователя о проблеме (в случае ошибки обработки);
- все ошибки сопровождаются **понятными сообщениями** для пользователя.

---

## AC-003: Безопасность и доступ
**Дано:** система работает в штатном режиме.  
**Когда:** пользователь обращается за статистикой.  
**Тогда:**
- доступ предоставляется только авторизованным пользователям с разрешенными **UserID в Telegram**;
- все запросы к **API Yclients** выполняются с использованием **авторизационного заголовка с токенами**;
- система не раскрывает данные пользователям без соответствующих прав.

---

## AC-004: Валидация входных данных
**Дано:** пользователь отправляет запрос с параметрами (**company_id, start_date, end_date**).  
**Когда:** система валидирует параметры.  
**Тогда:**
- даты должны быть в формате **YYYY-MM-DD**;
- значение **start_date** не позже **end_date**;
- некорректные запросы отклоняются с сообщением об ошибке.

---

## AC-005: Интеграция с API Yclients
**Дано:** ИИ агент формирует запрос к **API Yclients**.  
**Когда:** выполняется вызов API.  
**Тогда:**
- используется endpoint **GET /records/{company_id}** с параметрами **start_date** и **end_date**;
- заголовки **Accept** и **Content-Type** установлены согласно спецификации;
- ответ API корректно парсится и преобразуется в формат, удобный для пользователя.
## Use Case: Получение персонального плана ЗОЖ (питание и тренировки)

### Акторы

Пользователь

### Предусловие

Пользователь зарегистрирован и авторизован в приложении

### Ограничения

- План можно формировать не чаще одного раза в день
- Пользователь должен заполнить обязательные поля (цель, уровень подготовки, предпочтения)
- Все планы сохраняются в личном профиле
- Сгенерированные планы не заменяют консультацию врача или специалиста

### Триггер

Пользователь нажимает кнопку «Создать мой план на неделю»


### Основной сценарий 

1. **Пользователь** нажимает кнопку «Создать мой план на неделю»

2. **Система** отображает форму для ввода цели, уровня подготовки, ограничений по питанию и желаемого количества тренировок

3. **Пользователь** заполняет анкету (например: похудение, начальный уровень, без лактозы, 3 тренировки)

4. **Система** валидирует данные и отображает кнопку подтверждения

5. **Пользователь** нажимает кнопку «Сгенерировать план»

6. **Система** отправляет данные в LLM и формирует промт на основе анкеты

7. **Пользователь** ожидает ответ

8. **Система** обращается к RAG-модулю: ищет рецепты, упражнения, нормы БЖУ из базы знаний

9. **Пользователь** получает уведомление о готовности плана

10. **Система** отображает план на 7 дней: тренировки, меню, рекомендации

11. **Пользователь** выбирает «Сохранить» или «Скачать PDF»

12. **Система** сохраняет план в PostgreSQL и (при необходимости) генерирует PDF


### Альтернативный сценарий: Использование предыдущего плана

5а. **Пользователь** выбирает опцию «Использовать предыдущий план» <br>
6а. **Система** подгружает последний план из PostgreSQL <br>
7а. **Пользователь** вносит небольшие изменения (например, заменяет тип тренировки) <br>
8а. **Система** адаптирует план и отображает обновлённую версию <br>


### Исключительный сценарий 1: Ошибка при генерации LLM

6б. **Система** не получает ответ от LLM (временный сбой или превышен лимит)<br>
7б. **Пользователь** получает сообщение: «Ошибка при генерации. Попробуйте снова через несколько минут»<br>
8б. **Система** предлагает сохранить введённые данные и вернуться позже<br>


### Исключительный сценарий 2: Незаполненные или некорректные поля

4б. **Система** обнаруживает незаполненные обязательные поля<br>
5б. **Пользователь** видит сообщение об ошибке и указание, какие поля нужно заполнить<br>
6б. **Система** не отправляет данные в LLM до корректного заполнения формы<br>


### Исключительный сценарий 3: Пустой результат из RAG

8в. **Система** не находит подходящих материалов в базе знаний RAG<br>
9в. **Пользователь** видит сообщение: «Некоторые рецепты/упражнения временно недоступны. Использованы базовые рекомендации»<br>
10в. **Система** всё равно показывает план с заменами от LLM<br>
